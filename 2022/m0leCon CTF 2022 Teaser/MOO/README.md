# MOO

## Challenge [[Link]](https://ctftime.org/task/21240)
> One of the cows in our farm started to say weird numbers instead of MOOing, can you guess what it's saying?
>
> `nc challs.m0lecon.it 1753`
>
> Author: @brooklyn

## Solution

After interacting with the server, we found that for any input, it returns `(p - 1) * (q - 1)` or `(p - 1) / 2 * (q - 1) / 2`, which basically gives us `d = e^-1 % (p - 1) * (q - 1)` for free. With a traditional RSA setup we can simply get `m = c^d % n`.
```py
from Crypto.Util.number import long_to_bytes

n = 20182890523589257599585318450039583773932334416510248049024902437105764245957169144861649182102766049002530534024566416563880433629345584068924382544890130856580413811847921749924773692642064890806106024036247692779094258627259322856330050568182776633510659884991195499841267480832496284334988507180803004998191850413438129581995513524927793501
c = 3292094686998087590846547030287568236056263431507915541716631994901346153364636034128662026392057258249568019456697056361537605326197436505496100148177628590669259164476988572339064538039190579682465067302871695202408414813225066216743983424280736515205922645975236714017619191404972608760547291970246789410559236743755996290719708084683890035
e = 65537
# Server gives either ((p - 1) / 2 * (q - 1) / 2) or (p - 1) * (q - 1)
lambda_n = 2 * 10091445261794628799792659225019791886966167208255124024512451218552882122978584572430824591051383024501265267012283208281940216814672792034462191272444937699188867474541633858955160100974567423655822924268419003639646245520347608614630966939115984875165706864200966976536795186601258197154288165473410793036270056929683184571631007681359918366

d = power_mod(e, -1, lambda_n)
m = long_to_bytes(power_mod(c, d, n))
assert m == 'ptm{y0u_found_another_w4y_t0_factorize}'
print(m)
```

## Flag
`ptm{y0u_found_another_w4y_t0_factorize}`
